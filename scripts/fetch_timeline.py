# @Author: valentin
# @Date:   2016-05-16T21:53:30+02:00
# @Last modified by:   valentin
# @Last modified time: 2016-05-16T22:37:32+02:00

from bluebirdlib.connection import get_api
from bluebirdlib.user import userTimeline
from bluebirdlib.data import add_to_mongo, is_exists

from sys import argv
import pprint
import json


mourir_users = map(str, [723867498605608960, 706168969300996097, 720318610997051397, 2374311686, 730234107431665665, 1594402092, 40509578, 43437580, 2873467565, 41823889, 2344022562, 503749143, 83804569, 359494682, 383802907, 1872133789, 52349470, 244110368, 202629360, 1136368290, 356421531, 45365156, 264374565, 18399014, 231361832, 4894932700, 1665493034, 173097516, 4275730221, 140115118, 67646067, 2825223371, 881047992, 505084729, 1421181115, 47706812, 168830013, 4854571455, 1114897344, 493140803, 587187909, 618827078, 2705063495, 234513226, 2326693560, 2886183586, 1342848846, 363188408, 117713495, 14894863, 15823763, 972608696, 1344878431, 400334965, 226493669, 990514620, 3964163181, 225509872, 4805968114, 362066547, 560214644, 3068007413, 3069760247, 236621049, 96222715, 353478908, 717797934407032833, 154210430, 1516650044])
mort_users = map(str, [720641739023912960, 726002929321254912, 2216092162, 615029766, 726406171482030081, 463301771, 35287180, 208606733, 139686926, 1917753234, 2178785683, 187116312, 502130201, 104996507, 414892193, 3917704354, 712398116318744576, 92388806, 2480189737, 421972267, 741354354, 622154926, 735602610, 162848820, 160669314, 908435130, 2245959872, 705487529127051266, 255795398, 251261409, 274746359, 19288908, 1962707022, 3010431228, 2338383575, 92418008, 3019509723, 4928020474, 1028350686, 1209311, 4764953185, 126633700, 205620711, 248815465, 570955114, 3393727983, 2889995505, 592729202, 794133619, 1942157161, 91122810, 540196860, 620207230])
suicide_users = map(str, [716900277081735168, 730108386457460737, 4795567622, 731255254222770177, 521469965, 302369295, 2966469137, 24550940, 703976061160259585, 2417087016, 2814164028, 16104526, 257145426, 100986964, 2986535008, 537207393, 720783157012926464, 1651121766, 3988953191, 29897850, 4206729852, 79061630, 2350544514, 710620477631418368, 4559621772, 244600462, 1244458130, 343679171, 3226228884, 2553485468, 3367731874, 3384386723, 881347244, 607890100, 1606023864, 1363468483, 2437026507, 4207032014, 1333800150, 25835740, 25135325, 4515759329, 441261802, 1449088747, 2760506102, 328756473, 2919901436, 109046014, 43086079, 528898305, 3421645059, 720632902522789888, 595178247, 2546460428, 3219471122, 1014242076, 829154779, 7435562, 2345513779, 1219567926, 731210993221533696, 3224721734, 2435924299, 586161487, 286553425, 3404653396, 722488767500582912, 3043333984, 2909381990, 2973137769, 2719194484, 216657130, 66132864, 720705946578628608, 4681130900, 1328720802, 615566756, 19922341, 2937706415, 449278908, 184582605, 187494351, 96814033, 19001819, 2194395614, 1402180585, 54133226, 197811700, 34727931])



def main(user_id, api):
    tweets = map(lambda x: x.AsDict(), userTimeline(user_id, api, rec=1))
    print tweets[0]
    map(lambda x: add_to_mongo(x) if not is_exists(x["id"]) else None, tweets)
    return 0

if __name__ == "__main__":
    # if argv < 2:
    # 	print "usage ./fetch_timeline.py user_id"
    # else:
    # 	search = argv[1]

    for user_id in suicide_users:
        api = get_api("../")
        main(user_id, api)
